webpackJsonp([3],{"25za":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("Xxa5"),s=i.n(a),r=i("//Fk"),l=i.n(r),n=i("exGp"),o=i.n(n),c=i("mtWM"),d=i.n(c),u={data:function(){return{stepflag:0,options:[{value:"原图",label:"原图"}],value:"原图",fileReader:"",flag:!0,loading:!1,addpictureloading:!1,dialogVisible1:!1,CurrentSelectedPicture:null,dialogVisible2:!1,dialogVisible3:!1,currentDate:new Date,ischoose:[],EmbedWatermarkischoose:[],OriginalPictureischoose:[],url:"https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg",EmbedWatermarkurls:[],OriginalPictureurls:[],OriginalPictureIndex:null,EmbedWatermarkIndex:null,srcList:[[i("1Bnj")],[i("1Bnj")]]}},created:function(){this.InitDate(),window.FileReader||console.error("Your browser does not support FileReader API!"),this.fileReader=new FileReader},methods:{uploadSectionFile:function(e){var t=this;return o()(s.a.mark(function a(){var r,n,o;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:t.addpictureloading=!0,r=e.file,(n=new FormData).append("file",r),o=t,new l.a(function(t,a){var s=new FileReader;s.readAsDataURL(r),s.onload=function(a){var s=a.target.result,l=new Image;l.src=s,l.onload=function(a){l.width!=l.height?(o.$message({message:"非n*n的图片不允许上传!!",type:"error"}),t(!1)):(o.$axios.post("http://localhost:5000/addpicture/"+o.value,n).then(function(t){e.onSuccess(t),o.$message({message:"上传成功!!",type:"success"}),console.log("文件目录");var a=0;i("lBse").keys().forEach(function(e){var t=e.split("./")[1];console.log(a+":"+t),a++}),o.addpictureloading=!1,o.OriginalPictureIndex=r.name,o.srcList[0][0]=o.getpath(r.name,"original/")}).catch(function(t){var i=t.err;e.onError(i),console.log(i),o.$message({message:"上传失败!!",type:"success"}),o.addpictureloading=!1}),t(!0))}}}).then(function(e){return e});case 6:case"end":return a.stop()}},a,t)}))()},getpath:function(e,t){return e?i("8kxK")("./"+t+e):""},InitDate:function(){var e=this,t=i("CBxd"),a=0;t.keys().forEach(function(t){var i=t.split("./")[1];e.EmbedWatermarkurls[a]=i,a++});for(var s=0;s<=this.EmbedWatermarkurls.length;s++)this.EmbedWatermarkischoose[s]=!1;t=i("lBse"),a=0,t.keys().forEach(function(t){var i=t.split("./")[1];e.OriginalPictureurls[a]=i,a++});for(var r=0;r<=this.OriginalPictureurls.length;r++)this.OriginalPictureischoose[r]=!1},SelectWatermark:function(e){this.stepflag=2,null!=this.CurrentSelectedPicture&&(this.EmbedWatermarkischoose[this.CurrentSelectedPicture]=!1),this.EmbedWatermarkischoose[e]=!0,this.CurrentSelectedPicture=e,this.EmbedWatermarkIndex=this.EmbedWatermarkurls[e-1],this.dialogVisible1=!1,this.dialogVisible1=!0},SelectOriginalImage:function(e){this.stepflag=1,null!=this.CurrentSelectedPicture&&(this.OriginalPictureischoose[this.CurrentSelectedPicture]=!1),this.OriginalPictureischoose[e]=!0,this.CurrentSelectedPicture=e,this.OriginalPictureIndex=this.OriginalPictureurls[e-1],this.srcList[0][0]=this.getpath(this.OriginalPictureIndex,"original/"),this.dialogVisible2=!1,this.dialogVisible2=!0},handleCancel:function(){this.dialogVisible1=!1,this.dialogVisible2=!1,this.dialogVisible3=!1,this.InitDate()},handleConfirm:function(){this.dialogVisible1=!1,this.dialogVisible2=!1,this.dialogVisible3=!1,this.InitDate()},Preserve:function(){this.$message({message:"保存成功!!",type:"success"})},DetermineEmbedding:function(){var e=this;if(this.dialogVisible1=!1,this.dialogVisible2=!1,null!=this.OriginalPictureIndex){this.InitDate();var t={path:"D:/2023-2-6/image/original/"+this.OriginalPictureIndex};this.loading=!0,d.a.post("http://localhost:5000/EmbedWatermark",t).then(function(t){e.stepflag=3,e.$message({message:"嵌入成功!!",type:"success"}),e.srcList[1][0]=e.getpath(e.OriginalPictureIndex,"embedded/"),e.loading=!1}).catch(function(t){console.log(t),e.$message({message:"嵌入失败!!",type:"error"}),e.loading=!1})}else this.$message({message:"请选择原图!!",type:"error"})}}},g={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"embedwatermark",attrs:{"element-loading-text":"正在处理中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[i("el-row",[i("el-col",{attrs:{span:11}},[i("el-card",{staticClass:"leftel-card",attrs:{"body-style":{padding:"10px"},shadow:"hover"}},[i("el-image",{ref:"preview",staticClass:"image",attrs:{src:e.srcList[0][0],"preview-src-list":e.srcList[0]}}),e._v(" "),i("div",{staticStyle:{padding:"14px"}},[i("span",{staticStyle:{"font-size":"30px","font-weight":"700"}},[e._v("原图")]),e._v(" "),i("div",{staticClass:"bottom clearfix"},[i("el-button",{staticClass:"button",attrs:{type:"primary",round:""},on:{click:function(t){e.DetermineEmbedding()}}},[e._v("嵌入水印")]),e._v(" "),i("el-button",{staticClass:"button",attrs:{type:"primary",round:""},on:{click:function(t){e.dialogVisible3=!0}}},[e._v("上传图片")])],1)])],1)],1),e._v(" "),i("el-col",{attrs:{span:2}},[i("div",{staticStyle:{height:"300px","margin-top":"100px"}},[i("el-steps",{attrs:{direction:"vertical",active:e.stepflag,"finish-status":"success"}},[i("el-step",{attrs:{title:"上传原图"}}),e._v(" "),i("el-step",{attrs:{title:"嵌入水印"}})],1),e._v(" "),i("i",{staticClass:"el-icon-right"})],1)]),e._v(" "),i("el-col",{attrs:{span:11}},[i("el-card",{staticClass:"rightel-card",attrs:{"body-style":{padding:"10px"},shadow:"hover"}},[i("el-image",{ref:"preview",staticClass:"image",attrs:{src:e.srcList[1][0],"preview-src-list":e.srcList[1]}}),e._v(" "),i("div",{staticStyle:{padding:"14px"}},[i("span",{staticStyle:{"font-size":"30px","font-weight":"700"}},[e._v("嵌入水印图")]),e._v(" "),i("div",{staticClass:"bottom clearfix"},[i("el-button",{staticClass:"button",attrs:{type:"primary",round:""},on:{click:function(t){e.Preserve()}}},[e._v("保存")])],1)])],1)],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"请选择要嵌入的水印图片",visible:e.dialogVisible1,width:"80%"},on:{"update:visible":function(t){e.dialogVisible1=t}}},[i("div",{staticClass:"demo-image"},e._l(Math.ceil(e.EmbedWatermarkurls.length/6),function(t){return i("div",{key:t,staticClass:"block"},[i("el-row",e._l(6,function(a){return 6*(t-1)+a<=e.EmbedWatermarkurls.length?i("el-col",{key:a,attrs:{span:4}},[i("el-card",{class:[e.EmbedWatermarkischoose[6*(t-1)+a]?"selectedcard":"card"],attrs:{shadow:"hover"}},[i("img",{staticClass:"image",attrs:{src:e.getpath(e.EmbedWatermarkurls[6*(t-1)+a-1],"watermark/")},on:{click:function(i){e.SelectWatermark(6*(t-1)+a)}}})])],1):e._e()}),1)],1)}),0),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{round:""},on:{click:function(t){e.handleCancel()}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){e.DetermineEmbedding()}}},[e._v("确认嵌入")])],1)]),e._v(" "),i("el-dialog",{attrs:{title:"请选择原图",visible:e.dialogVisible2,width:"80%"},on:{"update:visible":function(t){e.dialogVisible2=t}}},[i("div",{staticClass:"demo-image"},e._l(Math.ceil(e.OriginalPictureurls.length/6),function(t){return i("div",{key:t,staticClass:"block"},[i("el-row",e._l(6,function(a){return 6*(t-1)+a<=e.OriginalPictureurls.length?i("el-col",{key:a,attrs:{span:4}},[i("el-card",{class:[e.OriginalPictureischoose[6*(t-1)+a]?"selectedcard":"card"],attrs:{shadow:"hover"}},[i("img",{staticClass:"image",attrs:{src:e.getpath(e.OriginalPictureurls[6*(t-1)+a-1],"original/")},on:{click:function(i){e.SelectOriginalImage(6*(t-1)+a)}}})])],1):e._e()}),1)],1)}),0),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{round:""},on:{click:function(t){e.handleCancel()}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){e.handleConfirm()}}},[e._v("确 定")])],1)]),e._v(" "),i("el-dialog",{attrs:{title:"添加图片",visible:e.dialogVisible3,width:"80%"},on:{"update:visible":function(t){e.dialogVisible3=t}}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.addpictureloading,expression:"addpictureloading"}],staticClass:"addpicture",attrs:{"element-loading-text":"正在上传中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[i("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:"","http-request":e.uploadSectionFile,multiple:""}},[i("i",{staticClass:"el-icon-upload"}),e._v(" "),i("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),i("em",[e._v("点击上传")])]),e._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[i("el-select",{attrs:{placeholder:"请选择上传图片类型"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),i("span",{staticStyle:{"font-size":"18px","font-weight":"400"}},[e._v("非n*n的图片不允许上传!!")])],1)])],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{round:""},on:{click:function(t){e.handleCancel()}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){e.handleConfirm()}}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var h=i("VU/8")(u,g,!1,function(e){i("NQ9Z")},"data-v-235bc711",null);t.default=h.exports},CBxd:function(e,t,i){var a={"./e66e715bc4f5e3aa801fc65f2899d50c.jpeg":"aK4z","./lena.png":"utRk","./user.jpg":"ZJh9"};function s(e){return i(r(e))}function r(e){var t=a[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}s.keys=function(){return Object.keys(a)},s.resolve=r,e.exports=s,s.id="CBxd"},NQ9Z:function(e,t){},lBse:function(e,t,i){var a={"./e66e715bc4f5e3aa801fc65f2899d50c.jpeg":"c8kO"};function s(e){return i(r(e))}function r(e){var t=a[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}s.keys=function(){return Object.keys(a)},s.resolve=r,e.exports=s,s.id="lBse"}});